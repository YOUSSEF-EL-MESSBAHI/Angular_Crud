{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/product.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/app-state.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction ProductsComponent_tr_18_td_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_tr_18_td_5_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const product_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.handleCheckProduct(product_r2));\n    });\n    i0.ɵɵelement(2, \"i\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const product_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMap(product_r2.checked ? \"bi bi-check\" : \"bi bi-circle\");\n  }\n}\nfunction ProductsComponent_tr_18_td_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_tr_18_td_6_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const product_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.handleDelete(product_r2));\n    });\n    i0.ɵɵelement(2, \"i\", 12);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsComponent_tr_18_td_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\")(1, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_tr_18_td_7_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const product_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.handleEdit(product_r2));\n    });\n    i0.ɵɵelement(2, \"i\", 13);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductsComponent_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, ProductsComponent_tr_18_td_5_Template, 3, 2, \"td\", 9);\n    i0.ɵɵtemplate(6, ProductsComponent_tr_18_td_6_Template, 3, 0, \"td\", 9);\n    i0.ɵɵtemplate(7, ProductsComponent_tr_18_td_7_Template, 3, 0, \"td\", 9);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const product_r2 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r2.price);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.appState.authState.roles.includes(\"ADMIN\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.appState.authState.roles.includes(\"ADMIN\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.appState.authState.roles.includes(\"ADMIN\"));\n  }\n}\nfunction ProductsComponent_li_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\")(1, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function ProductsComponent_li_20_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const i_r17 = restoredCtx.index;\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.handleGotoPage(i_r17 + 1));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const i_r17 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.appState.productsState.currentPage == i_r17 + 1 ? \"btn-success \" : \"btn-outline-success\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i_r17 + 1, \" \");\n  }\n}\nconst _c0 = function () {\n  return [];\n};\nexport let ProductsComponent = /*#__PURE__*/(() => {\n  class ProductsComponent {\n    constructor(productService, router, appState) {\n      this.productService = productService;\n      this.router = router;\n      this.appState = appState;\n    }\n    ngOnInit() {\n      this.searchProducts();\n    }\n    searchProducts() {\n      /*\r\n      this.appState.setProductState({\r\n        status :\"LOADING\"\r\n      });*/\n      this.productService.searchProducts(this.appState.productsState.keyword, this.appState.productsState.currentPage, this.appState.productsState.pageSize).subscribe({\n        next: resp => {\n          let products = resp.body;\n          let totalProducts = parseInt(resp.headers.get('x-total-count'));\n          //this.appState.productsState.totalProducts=totalProducts;\n          let totalPages = Math.floor(totalProducts / this.appState.productsState.pageSize);\n          if (totalProducts % this.appState.productsState.pageSize != 0) {\n            ++totalPages;\n          }\n          this.appState.setProductState({\n            products: products,\n            totalProducts: totalProducts,\n            totalPages: totalPages,\n            status: \"LOADED\"\n          });\n        },\n        error: err => {\n          this.appState.setProductState({\n            status: \"ERROR\",\n            errorMessage: err\n          });\n        }\n      });\n      //this.products=this.productService.getProducts();\n    }\n\n    handleCheckProduct(product) {\n      this.productService.checkProduct(product).subscribe({\n        next: updatedProduct => {\n          product.checked = !product.checked;\n          //this.getProducts();\n        }\n      });\n    }\n\n    handleDelete(product) {\n      if (confirm(\"Etes vous sûre?\")) this.productService.deleteProduct(product).subscribe({\n        next: value => {\n          //this.getProducts();\n          //this.appState.productsState.products=\n          //this.appState.productsState.products.filter((p:any)=>p.id!=product.id);\n          this.searchProducts();\n        }\n      });\n    }\n    handleGotoPage(page) {\n      this.appState.productsState.currentPage = page;\n      this.searchProducts();\n    }\n    handleEdit(product) {\n      this.router.navigateByUrl(`/admin/editProduct/${product.id}`);\n    }\n  }\n  ProductsComponent.ɵfac = function ProductsComponent_Factory(t) {\n    return new (t || ProductsComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AppStateService));\n  };\n  ProductsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsComponent,\n    selectors: [[\"app-products\"]],\n    decls: 21,\n    vars: 4,\n    consts: [[1, \"p-3\"], [1, \"card\"], [1, \"card-body\"], [\"type\", \"text\", 1, \"p-1\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn\", \"btn-outline-success\", \"ms-1\", 3, \"click\"], [1, \"bi\", \"bi-search\"], [1, \"table\"], [4, \"ngFor\", \"ngForOf\"], [1, \"nav\", \"nav-pills\"], [4, \"ngIf\"], [1, \"btn\", \"btn-outline-success\", 3, \"click\"], [1, \"btn\", \"btn-outline-danger\", 3, \"click\"], [1, \"bi\", \"bi-trash\"], [1, \"bi\", \"bi-pencil\"], [1, \"btn\", \"m-1\", 3, \"ngClass\", \"click\"]],\n    template: function ProductsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 2)(4, \"div\")(5, \"input\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function ProductsComponent_Template_input_ngModelChange_5_listener($event) {\n          return ctx.appState.productsState.keyword = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function ProductsComponent_Template_button_click_6_listener() {\n          return ctx.searchProducts();\n        });\n        i0.ɵɵelement(7, \"i\", 5);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(8, \"table\", 6)(9, \"thead\")(10, \"tr\")(11, \"th\");\n        i0.ɵɵtext(12, \"Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"th\");\n        i0.ɵɵtext(14, \"Price\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"th\");\n        i0.ɵɵtext(16, \"Checked\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(17, \"tbody\");\n        i0.ɵɵtemplate(18, ProductsComponent_tr_18_Template, 8, 5, \"tr\", 7);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"ul\", 8);\n        i0.ɵɵtemplate(20, ProductsComponent_li_20_Template, 3, 2, \"li\", 7);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.appState.productsState.keyword);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngForOf\", ctx.appState.productsState.products);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction0(3, _c0).constructor(ctx.appState.productsState.totalPages));\n      }\n    },\n    dependencies: [i4.NgClass, i4.NgForOf, i4.NgIf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel]\n  });\n  return ProductsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}